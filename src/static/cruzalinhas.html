<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <title>cruzalinhas</title>
        <link rel="Stylesheet" type="text/css" href="/static/layout.css"/>
        <script type="text/javascript" src="/static/jquery-1.4.2.min.js">
        </script>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">
        </script>
        <script type="text/javascript" src="/static/marcadores.js">
        </script>
        <script type="text/javascript" src="/static/fancybox/jquery.mousewheel-3.0.2.pack.js">
        </script>
        <script type="text/javascript" src="/static/fancybox/jquery.fancybox-1.3.1.pack.js">
        </script>
        <link rel="stylesheet" type="text/css" href="/static/fancybox/jquery.fancybox-1.3.1.css" media="screen" />
    </head>
    <body>
        <div id="div_main">
            <div class="titulo">
                cruzalinhas
            </div>
            <div class="subtitulo">
                saiba em um clique quais ônibus passam perto de um ponto  
            </div>
            <div class="menu">
                <a href="#div_oque" id="link_oque">o que é</a>
                - <a href="#div_porque" id="link_porque">por que</a>
                - <a href="#div_como" id="link_como">como funciona</a>
                - <a href="http://chester.blog.br/sobre" target="_blank">quem fez</a>
                - <a href="http://github.com/chesterbr/cruzalinhas" target="_blank">licença e código-fonte</a>
            </div>
            <div>
                <div id="div_conteudo_wrapper">
                    <div id ="div_conteudo">
                        <div id="div_busca">
                            <form id="form_busca">
                                <div id="div_busca_box">
                                    <input type="text" id="text_busca" class="input_instrucoes" value="(ex.: Avenida Paulista, 900)"/>
                                </div><input type="submit" value="Localizar">
                            </form>
                        </div>
                        <div id="map_canvas">
                            Carregando...
                        </div>
                    </div>
                </div>
                <div id="div_barra_wrapper">
                    <div id="div_barra">
                        <div id="div_lista">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Conteúdo que só aparece quando solicitado -->
        <div id="div_lightboxes">
            <div id="div_oque">
                <p>
                    O cruzalinhas permite obter a lista <b>completa</b>
                    das linhas de ônibus municipais que passam por um determinado lugar da cidade de São Paulo. É só colocar o marcador no mapa (clicando ou usando a caixa de busca) e o sistema lista e desenha as linhas.
                </p>
                <p>
                    Se você colocar outros marcadores, o sistema vai mostrar apenas as linhas que passam entre cada um deles. Com isso dá pra montar trajetos e comparar alternativas.
                </p>
                <p>
                    A localização pelo ponto é aproximada, então podem aparecer linhas próximas (aproveite isso para achar alternativas). Em caso de dúvida, clique no nome da linha e veja os dados dela no <a href="http://www.sptrans.com.br/itinerarios/">site da SPTrans</a>, onde a informação oficial pode ser consultada.
                </p>
                <p>
                    Lembre-se sempre que o serviço é experimental - <b>confirme</b>
                    antes de sair de casa. 
                </p>
            </div>
            <div id="div_porque">
                <p>
                    Quem usa transporte público em São Paulo sabe que existem algumas opções para se informar, tais como:
                </p>
                <ul>
                    <li>
                        <a href="http://www.sptrans.com.br/itinerarios/">SPTrans</a>: tem as informações oficiais;
                    </li>
                    <li>
                        <a href="http://www.toape.com.br/">Tô a Pé</a>: mostra as linhas de forma mais amigável;
                    </li>
                    <li>
                        <a href="http://maps.google.com">Google Maps</a>: a melhor opção para traçar rotas.
                    </li>
                </ul>
                <p>
                    A idéia não é substituir os sites acima, e sim oferecer um serviço complementar.
                </p>
                <p>
                    Além disso, o software demonstra <a href="http://github.com/chesterbr/cruzalinhas/blob/master/src/scraper.py">como obter</a>
                    os dados de itinerário das linhas - uma informação sobre serviço público que <a href="http://www.slideshare.net/pedrovalente/extraindo-dados-pblicos-na-marra-3489351">deveria estar disponível em formato apropriado</a>
                    mas, por algum motivo, não está.
                </p>
            </div>
            <div id="div_como">
                <p>
                    A aplicação foi feita em <a href="http://www.python.org/">Python</a>
                    e hospedada no <a href="http://code.google.com/appengine/">Google App Engine</a>.
                </p>
                <p>
                    Fazer uma busca por proximidade entre um ponto e cada trajeto é complicado: a princípio, seria preciso analisar cada segmento de reta, isso dentro de uma <a href="http://www.movable-type.co.uk/scripts/latlong.html">geometria nada trivial</a>. Entra em cena o <a href="http://en.wikipedia.org/wiki/Geohash">geohash</a>.
                </p>
                <p>
                    O que o sistema faz é manter pré-calculado o geohash da caixa que contem cada segmento de reta, num tamanho (6 caracteres) que dá uma margem de manobra menor que 1 Km. A busca é feita sobre o geohash do ponto a ser localizado, reduzido para esse mesmo tamanho.
                </p>
                <p>
                    Com isso, localiza-se as linhas, com uma margem de erro compatível com o fato de que o pino pode não cair exatamente sobre um trajeto (e que há interesse em pegar ônibus que passem "perto").
                </p>
                <p>
                    Os hashes da linha também são usados localmente para que, caso haja mais de um ponto no mapa, o cliente possa identificar as linhas que conectam cada um deles.
                </p>
            </div>
            <div id="div_instrucoes">
                <p>
                    digite um endereço &rarr;
                </p>
                <p>
                    ou clique no mapa &rarr;
                </p>
            </div>
        </div>
    </body>
</html>
